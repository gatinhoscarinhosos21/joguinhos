<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const scoreDisplay = document.getElementById('score');

  const imgCat = new Image();
  imgCat.src = 'https://i.imgur.com/QblI2dT.png';

  const player = {
    x: 180,
    y: 500,
    width: 40,
    height: 40,
    dy: 0,
    gravity: 0.3,       // Gravidade mais suave
    jumpForce: -8,      // Pulo um pouco mais leve
    speed: 4,
    isJumping: false
  };

  const platforms = [];
  const platformCount = 6;
  const platformWidth = 80;
  const platformHeight = 10;

  let score = 0;
  let maxHeight = player.y;

  const keys = {
    ArrowLeft: false,
    ArrowRight: false
  };

  // Criar plataformas iniciais
  for (let i = 0; i < platformCount; i++) {
    platforms.push({
      x: Math.random() * (canvas.width - platformWidth),
      y: i * 100,
      width: platformWidth,
      height: platformHeight
    });
  }

  function drawPlatform(p) {
    ctx.fillStyle = "#ff99cc";
    ctx.fillRect(p.x, p.y, p.width, p.height);
    ctx.fillStyle = "#ff66aa";
    ctx.fillRect(p.x + 10, p.y + 2, p.width - 20, 2);
  }

  function drawPlayer() {
    ctx.drawImage(imgCat, player.x, player.y, player.width, player.height);
  }

  function updateScore() {
    if (player.y < maxHeight) {
      score += Math.floor((maxHeight - player.y));
      maxHeight = player.y;
      scoreDisplay.textContent = `PontuaÃ§Ã£o: ${score}`;
    }
  }

  function update() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Movimento horizontal
    if (keys.ArrowLeft) player.x -= player.speed;
    if (keys.ArrowRight) player.x += player.speed;

    // Gravidade
    player.dy += player.gravity;
    player.y += player.dy;

    // ColisÃ£o com plataformas
    for (let p of platforms) {
      drawPlatform(p);

      if (
        player.dy >= 0 && // sÃ³ colide quando estÃ¡ caindo
        player.x + player.width > p.x &&
        player.x < p.x + p.width &&
        player.y + player.height >= p.y &&
        player.y + player.height <= p.y + 10
      ) {
        player.y = p.y - player.height;  // Posiciona em cima da plataforma
        player.dy = player.jumpForce;    // Pula novamente
        player.isJumping = false;
      }
    }

    // Scroll do cenÃ¡rio
    if (player.y < canvas.height / 2) {
      const delta = canvas.height / 2 - player.y;
      player.y = canvas.height / 2;

      for (let p of platforms) {
        p.y += delta;
      }

      updateScore();
    }

    // ReposiÃ§Ã£o de plataformas
    if (platforms[0].y > canvas.height) {
      platforms.shift();
      platforms.push({
        x: Math.random() * (canvas.width - platformWidth),
        y: platforms[platforms.length - 1].y - 100,
        width: platformWidth,
        height: platformHeight
      });
    }

    drawPlayer();

    // Game Over
    if (player.y > canvas.height) {
      alert(`Oh nÃ£o! O gatinho caiu ðŸ˜¿\nSua pontuaÃ§Ã£o: ${score}`);
      document.location.reload();
    }

    requestAnimationFrame(update);
  }

  document.addEventListener("keydown", (e) => {
    if (keys.hasOwnProperty(e.key)) keys[e.key] = true;
  });

  document.addEventListener("keyup", (e) => {
    if (keys.hasOwnProperty(e.key)) keys[e.key] = false;
  });

  imgCat.onload = () => {
    update();
  };
</script>

